{
    "steps": [
        {
            "name": "gcr.io/cloud-builders/docker",
            "args": [
                "build",
                "-t",
                "${_LOCATION}-docker.pkg.dev/$PROJECT_ID/${_REPOSITORY}/prediction-api-spotify-churn:0.0.1",
                "./prediction-api"
            ]
        },
        {
            "name": "gcr.io/cloud-builders/docker",
            "args": [
                "build",
                "-t",
                "${_LOCATION}-docker.pkg.dev/$PROJECT_ID/${_REPOSITORY}/prediction-ui-spotify-churn:0.0.1",
                "./prediction-ui"
            ]
        },
        {
            "name": "gcr.io/cloud-builders/docker",
            "args": [
                "push",
                "${_LOCATION}-docker.pkg.dev/$PROJECT_ID/${_REPOSITORY}/prediction-api-spotify-churn:0.0.1"
            ]
        },
        {
            "name": "gcr.io/cloud-builders/docker",
            "args": [
                "push",
                "${_LOCATION}-docker.pkg.dev/$PROJECT_ID/${_REPOSITORY}/prediction-ui-spotify-churn:0.0.1"
            ]
        },
        {
            "name": "gcr.io/google.com/cloudsdktool/cloud-sdk",
            "entrypoint": "gcloud",
            "args": [
                "run",
                "deploy",
                "prediction-api-spotify-churn",
                "--image",
                "${_LOCATION}-docker.pkg.dev/$PROJECT_ID/${_REPOSITORY}/prediction-api-spotify-churn:0.0.1",
                "--region",
                "us-central1",
                "--platform",
                "managed",
                "--port",
                "5000",
                "--cpu",
                "2",
                "--memory",
                "4G",
                "--allow-unauthenticated"
            ]
        },
        {
            "name": "gcr.io/google.com/cloudsdktool/cloud-sdk",
            "entrypoint": "gcloud",
            "args": [
                "run",
                "deploy",
                "prediction-ui-spotify-churn",
                "--image",
                "${_LOCATION}-docker.pkg.dev/$PROJECT_ID/${_REPOSITORY}/prediction-ui-spotify-churn:0.0.1",
                "--region",
                "us-central1",
                "--platform",
                "managed",
                "--port",
                "5000",
                "--cpu",
                "2",
                "--memory",
                "4G",
                "--set-env-vars",
                "PREDICTOR_API=todo",
                "--allow-unauthenticated"
            ]
        }
    ],
    "options": {
        "logging": "CLOUD_LOGGING_ONLY"
    }
}